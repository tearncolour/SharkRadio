# RoboMaster 2026 雷达与无线通信规范 (SDR Extraction)

> 本文档内容根据 《RoboMaster 2026 机甲大师超级对抗赛比赛规则手册V1.2.0》 及 《RoboMaster 2026 机甲大师高校系列赛通信协议 V1.1.0》 提取整理。

## 1. 物理层参数 (Physical Layer)

根据比赛规则与通信协议：

- **红方雷达发送频率**: `433.20 MHz` (需严格遵守)
- **蓝方雷达发送频率**: `433.92 MHz` (需严格遵守)
- **带宽 (Bandwidth)**: `500 kHz`
- **扩频因子 (SF)**: `7` (推荐)
- **编码率 (CR)**: `4/5` (推荐)

> 注：以上频率为 RoboMaster 赛事标准雷达频点。请务必遵守当地无线电管理规定。

---

## 2. 雷达特殊机制 (规则手册 5.6.6)

雷达通过无线链路向裁判系统发送对方机器人坐标，以积累“被标记进度” (P)。

### 2.1 识别误差 (d) 与进度影响 (x)

| 识别等级 | 判定条件 (误差 d) | x 更新逻辑 (若连续) | 非连续/中断 |
| :--- | :--- | :--- | :--- |
| **准确** | `d < 0.8m` | `x = x + 1.0` | `x = 1.0` |
| **半准确** | `0.8m ≤ d < 1.6m` | `x = x + 0.5` | `x = 0.5` |
| **错误** | `d ≥ 1.6m` | `x = x - 0.8` | `x = -0.8` |

- **数据中断**: 裁判系统每累计 **0.5 秒**未收到数据，视为触发一次“错误”判定。
- **P 的更新**: `P = P + x` (Range: 0 ~ 150)

### 2.2 标记效果

| P 值区间 | 小地图显示 | 增益效果 (地面机器人) |
| :--- | :--- | :--- |
| **[100, 120)** | 实时位置 | **15% 易伤** |
| **[120, 150]** | 实时位置 + 特殊标识 | **20% 易伤** |

---

## 3. 雷达无线链路协议 (协议 1.6)

雷达通过图传链路或专用无线模块与裁判系统/己方机器人通信。以下为协议定义的自定义控制器交互数据包结构。

### 3.1 协议头结构
- **Header**: 标准 RoboMaster 协议头
- **CmdID**: 通常使用用于机器人间交互的 ID
- **Content**: 如下表所示 (引用自 Protocol 1.6 Wireless Link Data Description)

### 3.2 数据内容定义 (Subset)

#### **0x0A01: 对方机器人位置数据**
| 偏移 | 大小(Byte) | 说明 |
| :--- | :--- | :--- |
| 0-1 | 2 | 对方英雄 x (cm) |
| 2-3 | 2 | 对方英雄 y (cm) |
| 4-5 | 2 | 对方工程 x (cm) |
| 6-7 | 2 | 对方工程 y (cm) |
| 8-9 | 2 | 对方 3号步兵 x (cm) |
| 10-11 | 2 | 对方 3号步兵 y (cm) |
| 12-13 | 2 | 对方 4号步兵 x (cm) |
| 14-15 | 2 | 对方 4号步兵 y (cm) |
| 16-17 | 2 | 对方空中 x (cm) |
| 18-19 | 2 | 对方空中 y (cm) |
| 20-21 | 2 | 对方哨兵 x (cm) |
| 22-23 | 2 | 对方哨兵 y (cm) |

#### **0x0A02: 对方机器人血量**
- **Offset 0**: 对方 1号英雄血量 (2B)
- **Offset 2**: 对方 2号工程血量 (2B)
- **Offset 4**: 对方 3号步兵血量 (2B)
- **Offset 6**: 对方 4号步兵血量 (2B)
- **Offset 10**: 对方 7号哨兵血量 (2B)

#### **0x0A04: 比赛状态数据 (部分)**
- **Offset 0**: 对方剩余金币 (2B)
- **Offset 4 (Bitmask)**: 
    - `bit 0`: 补给区占领
    - `bit 1-2`: 中央高地状态
    - `bit 4-5`: 堡垒状态
    - `bit 8`: 基地增益点状态
    - `bit 9`: 对方一侧飞坡前隧道 (1:被占领)
    - `bit 10`: 对方一侧飞坡后隧道 (1:被占领)
    - `bit 11`: 己方一侧飞坡前隧道 (1:被占领)
    - `bit 12`: 己方一侧飞坡后隧道 (1:被占领)
    - `bit 13`: 对方高地增益点 (1:被占领)
    - `bit 14`: 对方飞坡增益点 (1:被占领)
    - `bit 15`: 对方公路增益点 (1:被占领)

#### **0x0A05: 对方机器人增益数据**
每个机器人占用 7 字节 (哨兵 8 字节)，包含回血、冷却、防御、负防御、攻击增益。

| 偏移 (Hero) | 偏移 (Eng) | 偏移 (Inf3) | 偏移 (Inf4) | 偏移 (Sentry) | 大小 | 说明 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 0 | 7 | 14 | 21 | 28 | 1 | 回血增益 (%) |
| 1 | 8 | 15 | 22 | 29 | 2 | 冷却增益 (val) |
| 3 | 10 | 17 | 24 | 31 | 1 | 防御增益 (%) |
| 4 | 11 | 18 | 25 | 32 | 1 | 负防御增益 (%) |
| 5 | 12 | 19 | 26 | 33 | 2 | 攻击增益 (%) |
| - | - | - | - | 35 | 1 | 哨兵当前姿态 |

---

## 4. 总结与实现建议

1.  **SDR 配置**:
    - 必须严格区分紅蓝方频率 (红 433.20 / 蓝 433.92)。
    - 必须保证带宽控制在 500kHz 左右。
2.  **数据发送**:
    - 建议发送频率: **5Hz - 10Hz** (平衡刷新率与丢包率)。
    - 根据规则，连续发送准确数据能加速 P 值积累，因此稳定性至关重要。
3.  **UI 显示**:
    - 客户端应解析 `0x0A01` 并在地图上绘制位置。
